\subsection{Solution algorithm}
Algorithm \ref{algo:dec} is a variant of the dual subgradient method, where two are the main steps:
\begin{itemize}
    \item computation of the subgradient of the dual function (line 5);
    \item update of the Lagrange multipliers with $\alpha$ as step size (lines 10-13).
\end{itemize}
The maximum and minimum operations are to be intended component-wise.
Notice the decreased number of inputs with respect to the centralized algorithm.

\begin{algorithm}[H]
    \label{algo:dec}
    \caption{Decentralized algorithm.}
    \SetKwInOut{Input}{Input}
    \SetKwInOut{Output}{Output}

    \Input{$\Big\{N, T, m, (P^{max}_i, P^{ref}_i)_{i=1}^N, (\xi_{p,i})_{i,p=1}^{N,m}\Big\}$}
    \Output{$\Big\{(P^{ch}_{p,i}, P^{dis}_{p,i})_{i,p=1}^{N,m}\Big\}$}

    \BlankLine
    \tcp{Initialize the variables}
    $k=0$, $\lambda(k)=0$, $\mu(k)=0$, $\nu(k)=0$ \\
    $\overline{s}_p = -\infty$, $\underline{s}_p = +\infty$ for $p=1,\dots,m$
    
    \BlankLine
    \tcp{Outer optimization problem}
    \Repeat{termination condition is met}{
        \For{$p=1,...,m$}{
            \tcp{Inner optimization problem}
            \vspace*{-0.4cm}
            \begin{gather*}
                P_{p}(k+1) = \argmin_{P_p} \Big[P_p(k)\Big(\xi_p + \lambda(k)+ \\
                + \mu(k)- \nu(k)\Big)\Big] \\
                s.t. \quad (\ref{constr:c1})-(\ref{constr:c5}), (\ref{constr:c8})-(\ref{constr:c10})
            \end{gather*}

            $\overline{s}_p = \max\{\overline{s}_p, P_p(k+1)\}$ \\
            $\underline{s}_p = \min\{\underline{s}_p, P_p(k+1)\}$ \\
            $\rho_p(k+1) = \overline{s}_p - \underline{s}_p$
        }
        \BlankLine
        \tcp{Update the multipliers}
        $\rho(k+1) = N \max\Big\{\Big(\rho_p(k+1)\Big)_{p=1}^m\Big\}$ \\
        $\lambda (k+1) =$ $max\Big\{0,\lambda (k) + a(k)\Big(\sum^{m}_{p=1} P_p(k+ 1) - P^{max} + \rho\Big)\Big\}$\;
        $\mu (k+1) = max\Big\{0,\mu (k) + a(k)\Big(\sum^{m}_{p=1} P_p(k+ 1) - P^{ref}\Big)\Big\}$\;
        $\nu (k+1) = max\Big\{0,\nu (k) - a(k)\Big(\sum^{m}_{p=1} P_p(k+ 1) - P^{ref} \Big)\Big\}$\;
        $k++$
    }
\end{algorithm}